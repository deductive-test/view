<!DOCTYPE html>
<html lang="ja">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
	<title>TL_panel</title>

	<!-- <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet"> -->
	<link href="https://cdn.jsdelivr.net/npm/@mdi/font@6.x/css/materialdesignicons.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
	<style>
		[v-cloak] {
			display: none !important;
		}
	</style>
</head>

<body>
	<div id="app" v-cloak>
		<v-app>
			<v-main>
				<v-container>

					<v-app-bar fixed app dense flat color="#fff">
						<v-btn icon @click="showDialogInfo">
							<v-row no-gutters>
								<v-col cols="12" align="center">
									<v-icon>mdi-information-outline</v-icon>
								</v-col>
								<v-col cols="12" class="text-caption" align="center">info</v-col>
							</v-row>
						</v-btn>
						<v-spacer></v-spacer>
						Touken Ranbu Panel Viewer
						<v-spacer></v-spacer>
						<v-btn icon @click="input.cell=['','','','','','','','','',]">
							<v-row no-gutters>
								<v-col cols="12" align="center">
									<v-icon>mdi-reload</v-icon>
								</v-col>
								<v-col cols="12" class="text-caption" align="center">reload</v-col>
							</v-row>
						</v-btn>
					</v-app-bar>
	
					<v-row dense v-for="rowY in 3" :key="'rowY-'+rowY">
						<v-col v-for="colX in 3" :key="'colX-'+colX">
							<v-card v-ripple @click="showDialog((rowY - 1) * 3 + colX)"
							:class="input.cell[(rowY - 1) * 3 + colX -1] ? 'black--text' : 'grey--text'">
								<v-card-title class="justify-center">{{(rowY - 1) * 3 + colX}}</v-card-title>
								<v-card-text :class="`text-center ${input.cell[(rowY - 1) * 3 + colX -1] ? 'black--text' : 'grey--text'}`">
									{{input.cell[(rowY - 1) * 3 + colX -1]||'not set'}}
								</v-card-text>
							</v-card>
						</v-col>
					</v-row>

					<v-row class="pt-3"><v-col>lastModified: {{lm}}</v-col></v-row>

					<div style="text-align: right;">
						<br><br><br>
						<button class="white--text" @click="changeDebugMode">{{debugCount}}</button>
					</div>
					<div v-show="isDebug" style="word-break: break-all;">
						<div>isDebug</div>
						<div><a :href="URL.href">{{URL.href}}</a></div>
						<br>
						<div>$vuetify.breakpoint.name: {{$vuetify.breakpoint.name}}</div>
					</div>

				</v-container>
			</v-main>

			<v-overlay :value="loading">
				<v-progress-circular indeterminate :size="200" @click="loading = !loading" />
			</v-overlay>

			<v-dialog v-model="infoDialog.show" max-width="600" scrollable>
				<v-card>
					<v-card-title class="justify-center">Info</v-card-title>
					<v-divider></v-divider>
					<v-card-text class="black--text pa-4">
						<v-row>
							<v-col>
								Author: <a href="https://x.com/deductive_test" target="_blank">@deductive_test</a>
							</v-col>
						</v-row>
					</v-card-text>
					<v-divider></v-divider>
					<v-card-actions>
						<v-spacer></v-spacer>
						<v-btn text color="grey" @click="infoDialog.show=false">Close</v-btn>
						<v-spacer></v-spacer>
					</v-card-actions>
				</v-card>
			</v-dialog>

			<v-dialog v-model="inputDialog.show" max-width="600" scrollable>
				<v-card>
					<v-card-title class="justify-center">setting cell {{inputDialog.id}}</v-card-title>
					<v-divider></v-divider>
					<v-card-text class="black--text pa-4">
						<v-row>
							<v-col>
								<v-text-field v-model="input.keyword" dense outlined hide-details clearable label="keyword"></v-text-field>
							</v-col>
						</v-row>
						<v-row class="mt-0">
							<v-col>

								<v-list v-if="showSoubi.length>0" dense class="py-0">
									<v-list-group :value="true">
										<template v-slot:activator>
											<v-list-item-title>装備 ({{showSoubi.length==select.soubi.length ? select.soubi.length : `${showSoubi.length}/${select.soubi.length}`}})</v-list-item-title>
										</template>
										<template v-for="(l1,l1i) in showSoubi">
											<v-list-item link :key="'l1i-'+l1i" @click="setCell(l1)">
												{{l1}}
											</v-list-item>
											<v-divider :key="'l1ib-'+l1i"></v-divider>
										</template>
									</v-list-group>
								<v-divider></v-divider>
								</v-list>

								<v-list v-if="showTouha.length>0" dense class="py-0">
									<v-list-group :value="true">
										<template v-slot:activator>
											<v-list-item-title>刀派 ({{showTouha.length==select.touha.length ? select.touha.length : `${showTouha.length}/${select.touha.length}`}})</v-list-item-title>
										</template>
										<template v-for="(l2,l2i) in showTouha">
											<v-list-item link :key="'l2i-'+l2i" @click="setCell(l2)">
												{{l2}}
											</v-list-item>
											<v-divider :key="'l2ib-'+l2i"></v-divider>
										</template>
									</v-list-group>
								<v-divider></v-divider>
								</v-list>

								<v-list v-if="showSwordType.length>0" dense class="py-0">
									<v-list-group :value="true">
										<template v-slot:activator>
											<v-list-item-title>刀種 ({{showSwordType.length==select.swordType.length ? select.swordType.length : `${showSwordType.length}/${select.swordType.length}`}})</v-list-item-title>
										</template>
										<template v-for="(l3,l3i) in showSwordType">
											<v-list-item link :key="'l3i-'+l3i" @click="setCell(l3)">
												{{l3}}
											</v-list-item>
											<v-divider :key="'l3ib-'+l3i"></v-divider>
										</template>
									</v-list-group>
								<v-divider></v-divider>
								</v-list>

								<v-list v-if="showOther.length>0" dense class="py-0">
									<v-list-group :value="true">
										<template v-slot:activator>
											<v-list-item-title>他 ({{showOther.length==select.other.length ? select.other.length : `${showOther.length}/${select.other.length}`}})</v-list-item-title>
										</template>
										<template v-for="(l4,l4i) in showOther">
											<v-list-item link :key="'l4i-'+l4i" @click="setCell(l4)">
												{{l4}}
											</v-list-item>
											<v-divider :key="'l4ib-'+l4i"></v-divider>
										</template>
										</v-list-group>

								</v-list>
							</v-col>
						</v-row>
					</v-card-text>
					<v-divider></v-divider>
					<v-card-actions>
						<v-spacer></v-spacer>
						<v-btn text color="error" @click="setCell('')">Delete Setting</v-btn>
						<v-spacer></v-spacer>
					</v-card-actions>
				</v-card>
			</v-dialog>

		</v-app>

	</div>

	<script src="https://cdn.jsdelivr.net/npm/jquery@3.x"></script>
	<script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script><!-- .min cant debug -->
	<script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.js"></script>
	<script>
	const myvue = new Vue({
		el: '#app',
		vuetify: new Vuetify(),
		components: {
		},
		computed: {
			showSoubi () {
				let res = JSON.parse(JSON.stringify(this.select.soubi))
				try {
					if (!this.input.keyword) return res
					res = res.filter(x=>x.includes(this.input.keyword))
				} catch (e) { console.error(e) }
				return res
			}, // showSoubi

			showTouha(){
				let res = JSON.parse(JSON.stringify(this.select.touha))
				try {
					if (!this.input.keyword) return res
					res = res.filter(x=>x.includes(this.input.keyword))
				} catch (e) { console.error(e) }
				return res
			},//showTouha

			showSwordType(){
				let res = JSON.parse(JSON.stringify(this.select.swordType))
				try {
					if (!this.input.keyword) return res
					res = res.filter(x=>x.includes(this.input.keyword))
				} catch (e) { console.error(e) }
				return res
			},//showSwordType

			showOther(){
				let res = JSON.parse(JSON.stringify(this.select.other))
				try {
					if (!this.input.keyword) return res
					res = res.filter(x=>x.includes(this.input.keyword))
				} catch (e) { console.error(e) }
				return res
			},//showOther

		},
		data: {
			debugCount:0,
			isDebug: false,
			loading:true,
			cl: {year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit',second:'2-digit',fractionalSecondDigits:3},
			lm:'',
			URL:{},
			input:{
				keyword:'',
				cell:['','','','','','','','','',]
			},
			inputDialog:{
				show:false,
				id:0,
			},
			infoDialog:{show:false,},

			select:{
				soubi:[
					'槍兵1',
					'精鋭兵1',
					'重騎兵1',
					'軽歩兵2',
					'軽騎兵2',
					'重歩兵2',
					'弓兵2',
					'投石兵2',
					'銃兵2',
					'盾兵2',
					'馬3',
				],
				touha:[
					'三条2',
					'堀川2',
					'兼定2',
					'来2',
					'粟田口2',
					'左文字2',
					'貞宗1',
					'青江1',
					'村正1',
					'虎徹1',
					'長船1',
				],
				swordType:[
					'短刀2 夜戦',
					'脇差2 夜戦',
					'打刀2 夜戦',
					'太刀2',
					'大太刀2',
					'槍2',
					'薙刀2',
					'二刀開眼(脇差1打刀1)',
				],
				other:[
					'初合計Lv90',
					'極1',
					'乱舞Lv4以上1',
					'勝利 1ターン',
					'勝利 A評価',
					'屋内',
					'屋内 夜',
					'市街',
					'市街 夜',
					'市街 雨(7-2)',
					'城内 夜(7-4遠戦全無効)',
				],
			},

		}, // data
		mounted() {
			this.lm = new Date(document.lastModified).toLocaleString()
			const url = new URL(location.href)
			this.URL = {
				href: location.href,
				origin: url.origin,
				query: Object.fromEntries(url.searchParams),
				BASE: url.origin + '/',
			}
			this.loading = false
			console.log(`${new Date().toLocaleString('ja-JP',this.cl)} [mounted] end`)
		}, // mounted
		methods: {
			showDialog(id){
				this.input.keyword=''
				this.inputDialog.id=id
				this.inputDialog.show=false
				this.$nextTick(()=>this.inputDialog.show=true)
			},//showDialog(id)

			setCell(v){
				this.input.cell[this.inputDialog.id-1]=v
				this.inputDialog.show=false
			},//setCell(l1)

			showDialogInfo(){
				this.infoDialog.show=false
				this.$nextTick(()=>this.infoDialog.show=true)
			},//showDialogInfo



			// --------------------------------------------------
			// common
			// --------------------------------------------------
			changeDebugMode () {
				this.debugCount++
				console.log(`${new Date().toLocaleString('ja-JP',this.cl)} [changeDebugMode] debugCount = ${this.debugCount}`)
				if (this.debugCount % 10 === 0) {
				this.isDebug = !this.isDebug
				}
			}, // changeDebugMode
		}, // methods
	})
	</script>

	<style>
		.v-btn {
		text-transform: none;
		}
		.aic {align-items: center;}
		.asc {align-self: center;}
	
		table.json-table {
			border-spacing: 0;
		}
	
		table.json-table tr:not(:last-of-type) td {
			border-bottom: 1px solid #ccc;
		}
	
		table.json-table td:not(:first-of-type) {
			border-left: 1px solid #ccc;
		}
		.v-toolbar__content {
			/* .theme--light.v-divider */
			border-bottom: 1px solid rgba(0, 0, 0, 0.12);
		}
	</style>

</body>
</html>